{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "name": {
            "type": "string"
        },
        "additional_host_name": {
            "type": "string",
            "defaultValue": "defualt",
            "metadata": {
              "description": "An additional hostname this application should be accessible on"
            }
          },
        "is_frontend": {
            "type": "string"
        },
        "gatewayId": {
        }
    },
"resources": [
{
    "condition": "[not(equals(parameters('is_frontend'), '0'))]",
    "type": "Microsoft.Network/trafficManagerProfiles",
    "name": "[parameters('name')]",
    "apiVersion": "2017-05-01",
    "location": "global",
    "properties": {
        "profileStatus": "Enabled",
        "trafficRoutingMethod": "Priority",
        "dnsConfig": {
            "relativeName": "[concat('hmcts-', parameters('name'))]",
            "fqdn": "[concat('hmcts-', parameters('name'),'.trafficmanager.net')]",
            "ttl": 100
        },
        "monitorConfig": {
            "protocol": "HTTP",
            "port": 80,
            "path": "/",
            "intervalInSeconds": 30,
            "toleratedNumberOfFailures": 3,
            "timeoutInSeconds": 10
        },
        "endpoints": [
            {
                "name": "shutter",
                "type": "Microsoft.Network/trafficManagerProfiles/azureEndpoints",
                "properties": {
                    "endpointStatus": "Disabled",
                    "targetResourceId": "[resourceId('mojmaintenancepage', 'Microsoft.Web/sites', 'mojmaintenance')]",
                    "target": "mojmaintenance.azurewebsites.net",
                    "weight": 1,
                    "priority": 1,
                    "endpointLocation": "UK South"
                }
            },
            {
                "name": "app",
                "type": "Microsoft.Network/trafficManagerProfiles/azureEndpoints",
                "properties": {
                    "endpointStatus": "Enabled",
                    "targetResourceId": "[parameters('gatewayId')]",
                    "weight": 2,
                    "priority": 2,
                    "endpointLocation": "UK South"
                }
            }
        ]
    },
    "dependsOn": []
  }
]
}